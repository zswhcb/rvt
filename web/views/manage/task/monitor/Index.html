<!DOCTYPE html>
<html>
	<head>
		#parse('front/_pagelet/Common.IndexHeader.html')
		<link rel='stylesheet' type='text/css' href='/public/assets/css/manage/1.0.1/index.css' />
		<link rel='stylesheet' type='text/css' href='/public/assets/css/manage/1.0.1/iframe.css' />
	</head>
	<body>
		<div class='container'>
			<div class='row'>
				<div class='col-sm-12 col-md-12'>
					<ol class='breadcrumb'>
						<li class='active'><i class='fa fa-home fa-fw'></i> 后台管理</li>
						<li class='active'><a href='javascript:location.reload();'>任务监控</a></li>
					</ol>
				</div>
				<div class='col-sm-12 col-md-6'>
					<div class='panel panel-default table-responsive'>
						<div class='panel-heading'>
							<div class='btn-group btn-group-xs'>
								<button class='btn btn-primary glyphicon glyphicon-refresh' onclick='location.reload()'>刷新</button>
							</div>
						</div>
						#parse('manage/task/monitor/_pagelet/Side.List.Task.html')
					</div>
				</div>
				<div class='col-sm-12 col-md-6'>
					<div class='panel panel-default table-responsive'>
						<div class='panel-heading'>
							<div class='btn-group btn-group-xs'>
								<button class='btn btn-primary glyphicon glyphicon-refresh' onclick='location.reload()'>刷新</button>
							</div>
						</div>
						<table id='table2' data-olx-type='olx.grid' class='table table-bordered table-hover table-condensed table-striped' data-url='/role/list' data-current='1' data-pagesize='20' data-count='561'>
						#parse('manage/task/monitor/_pagelet/Side.List.HandTask.html')
						</table>
					</div>
				</div>
			</div>
		</div>
		#parse('front/_pagelet/Common.IndexJs.html')
		#parse('manage/_pagelet/Common.Iframe.html')
		<script>
			$(function(){
				$('input:radio[name="PROJECT_ID"]').attr('checked', false);
				// TODO
				$('input:radio[name="PROJECT_ID"]').change(function (obj){
					var project_id = obj.target.defaultValue;
					// TODO
					$.ajax({
						url: './getTasks/'+ project_id,
						type: 'POST',
						dataType: 'JSON'
					}).done(function (data){
						if(!data.success) return $('#table2').html('');
						$('#table2').html(data.data);
					});
				});
				// TODO
				$('#btn_add').click(function(){
					var project_id = $('input:radio[name="PROJECT_ID"]:checked').val();
					if(!project_id) return;
					parent.location.href = '/manage/#page/task/add?project_id='+ project_id;
				});
				// TODO
				$('#btn_del').click(function(){
					var task_id = $('input:radio[name="TASK_ID"]:checked').val();
					if(!task_id) return;
					// TODO
					if(confirm('确定要执行该操作吗？')){
						// TODO
						$.ajax({
							url: './del/'+ task_id,
							type: 'POST',
							dataType: 'JSON'
						}).done(function (data){
							location.reload();
						});
					}
				});
				// TODO
				$('#searchFrm_btn_search').click(function(){
					var formObj = $('#searchFrm').serializeObjectForm();
					console.log(formObj);
				});
			});
		</script>
	</body>
</html>